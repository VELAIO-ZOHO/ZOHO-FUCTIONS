
/// Config APIs
moduleName = "CustomModule3";
headers = Map();
headers.put("content-type","application/x-www-form-urlencoded");

/// URIS
uriGetRecords = 'https://recruit.zoho.com/recruit/private/json/' + moduleName + '/getRecords?scope=recruitapi&version=2&newFormat=2&sortColumnString=' + moduleName + '+Name&fromIndex=200&toIndex=400';

/// Busca todos los registros en Historial de estados
statusHistoryReponse = Map();
statusHistoryReponse = invokeurl
[
	url :uriGetRecords
	type :POST
	parameters:Map()
	headers:headers
	connection:"oauthzrecruit"
];
// info statusHistoryReponse;
// obtenemos la lista con los registros
data = statusHistoryReponse.getJSON("response").getJSON("result").getJSON(moduleName).getJSON("row");
for each record in data
{
  recordFLs = record.getJSON("FL");
  moduleRecordId = recordFLs.get(0).getJSON("content");
  nameJobOffer = "";
  for each fl_item in recordFLs
  {
    if(fl_item.getJSON("val") == "Oferta")
    {
      nameJobOffer = fl_item.getJSON("content");
    }
  }
  xmlData = 'xmlData=<' + moduleName + '><row no="1"><FL val="Nombre oferta">'+nameJobOffer+'</FL></row></' + moduleName + '>';
  // info "registro id: " + moduleRecordId;
  // info xmlData;
  uriUpdateRecords = 'https://recruit.zoho.com/recruit/private/xml/' + moduleName + '/updateRecords?newFormat=2&scope=recruitapi&id='+moduleRecordId+'&version=2';
  
  response = invokeurl
  [
    url :uriUpdateRecords
    type :POST
    parameters:xmlData
    headers:headers
    connection:"oauthzrecruit"
  ];
  info response;
}


